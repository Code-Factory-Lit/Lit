<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>list</title>
<!--    <link rel="stylesheet" href="/src/main/resources/static/assets/css/main/main.css" />-->
<!--    <link rel="stylesheet" href="/src/main/resources/static/assets/css/default.css" />-->
<!--    <link rel="stylesheet" href="/src/main/resources/static/assets/css/header.css" />-->
<!--    <link rel="stylesheet" href="/src/main/resources/static/assets/css/footer.css" />-->
    <link rel="stylesheet" href="/assets/css/main/main.css"/>
    <link rel="stylesheet" href="/assets/css/default.css"/>
    <link rel="stylesheet" href="/assets/css/header.css" />
    <link rel="stylesheet" href="/assets/css/footer.css" />
    <style>
        div.photoContents {
            height: 100%;
        }
        div.photoContents > div {
            display: flex;
            flex-wrap: wrap;
        }
        div.photoContents figure {
            width: 33.33%;
            height: 293px;
            padding: 10px;
        }

        div.photoContents figure a {
            display: block;
            height: 100%;
            overflow: hidden;
        }
        div.photoContents figure img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: .5s ease;
            transform-origin: center center;

        }
        div.photoContents img:hover {
            transform: scale(1.1);
            transform-origin: center center;
        }
    </style>

</head>

<body>
    <header th:insert="~{/header :: header}"></header>
    <main>
        <div class="_main_wrapper">
            <div class="_main_top_wrapper">
                <!-- 카테고리 선택 창 -->
                <div class="_category_wrapper">
                    <a href="life">
                        <div class="_category_detail _life">
                            <div class="_category_img_box" style="padding:10px ;">
                                <div class="_category_img">
                                    <img class="_img" src="/images/main/life.png">
                                </div>
                            </div>
                            <div class="_category_write">
                                생 활
                            </div>
                        </div>
                    </a>
                    <a href="exercise">
                        <div class="_category_detail _exercise">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/exercise.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                운 동
                            </div>
                        </div>
                    </a>
                    <a href="hobby">
                        <div class="_category_detail _hobby">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/hobby.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                취 미
                            </div>
                        </div>
                    </a>
                    <a href="art">
                        <div class="_category_detail _art">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/art.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                예 술
                            </div>
                        </div>
                    </a>
                    <a href="heart">
                        <div class="_category_detail _heart">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/heart.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                정 서
                            </div>
                        </div>
                    </a>
                    <a href="eating">
                        <div class="_category_detail _eating">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/eating.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                식 습 관
                            </div>
                        </div>
                    </a>
                    <a href="study">
                        <div class="_category_detail _study">
                            <div class="_category_img_box">
                                <div class="_category_img">
                                    <img src="/images/main/study.png" class="_img">
                                </div>
                            </div>
                            <div class="_category_write">
                                공 부
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <!-- 본문 시작 -->
            <div class="_main_bottom_wrapper">
                <!-- 변경 버튼 -->
                <div class="litChange">
                    <div>
                        <a class="lits1On" id="lits1" >
                            <div><img class="litSvg" id="lit1Img" src="/images/mypage/menu.png">
                                <span class="litSpan">Lit up</span>
                            </div>
                        </a>
                    </div>
                    <div>
                        <a class="lits2Off" id="lits2" href="/list/litups"
                            <div><img class="litSvg" id="lit2Img" src="/images/mypage/fire.png">
                                <span class="litSpan">Lits</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- 프로젝트 시작 -->
                <div class="photoContents">
                    <div>
<!--                        <figure>-->
<!--                            <a href="">-->
<!--                                <img alt="" src="">-->
<!--                            </a>-->
<!--                        </figure>-->

                    </div>
                </div>
            </div>
        </div>

<!--        <footer th:insert="~{/footer :: footer}"></footer>-->
    </main>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
 <script src="/assets/js/main/main.js"></script>
<!--<script src="/src/main/resources/static/assets/js/main/main.js"></script>-->

<script th:inline="javascript">

    let pageNum = 1;
    const contBox = $('div.photoContents > div');

    // 기본 시작은 lit
    litList("lanking");

    function litList(category) {
        $.ajax({
            url: "/list/lits/" + category + "/" + pageNum,
            type: "get",
            dataType: 'json',
            success: function (result) {
                pageNum++; // 다음 페이지 번호 지정
                // alert('성공');
                listadd(result);
            }, error: function (xhr, textStatus, errorThrown) {
                console.log('통신 실패');
                console.log(xhr);
                console.log(textStatus);
                console.log(errorThrown);
            }
        });
    }

    // 리스트에 추가하기
    function listadd(result) {
        let str = "";  // 리스트 html 담을 변수

        $.each(result, function (i, projectVO) {
            let src = "/lit/display?fileName=";
            //이미지 경로
            src += projectVO.projectFile.uploadPath + "/";
            src += projectVO.projectFile.uuid + "_";
            src += projectVO.projectFile.name;

            str += " <figure><a href='"+projectVO.projectNumber+"'>";
            str += " <img src='" + "/lit/display?fileName=" + projectVO.projectFile.uploadPath +  "/" + projectVO.projectFile.uuid + "_" + projectVO.projectFile.name + "'> ";
            str += "</a></figure>";
        });
        contBox.append(str);
    }

    // 카테고리 클릭시 이벤트 페이지 이동
    $("._category_wrapper a").on("click", function (e) {
        e.preventDefault();
        if( $(this).hasClass("on") ){  // 같은 태그 선택시 이벤트 취소
            return false;
        }

        // 선택 태그 클래스 주입
        $("._category_wrapper a").removeClass("on");
        $(this).addClass("on");
        contBox.html();  // 이미지 리스트 초기화
        let category = $(this).attr("href"); // 링크 변수값( 카테고리 값 )
        console.log(category);
        litList(category);
    });

    // 리스트 클릭시 페이지 이동
    $("photoContents a").on("click", function (e) {
        e.preventDefault();
        let link = $(this).attr("href"); // 링크 변수값
        console.log(link);
        // location.href="";
    });

    //스크롤 이벤트
    let timer;
    $(window).scroll(function () {
        // 현 스크롤 탑의 위치
        let windowTop = $(window).scrollTop();
        // 변화될 아이
        let contentHeight = $(".photoContents").height();
        // 창의 전체 높이
        let windowHeight = $(window).height();

        // 스크롤이 마지막 이면 데이터 가져오기
        if (windowTop > (contentHeight - windowHeight)) {
            // 스크롤 맨 아래
            if (timer) {
                clearTimeout(timer);
            }
            timer = setTimeout(() => {
                // ajax 실행
                litList("lanking");
            }, 500);
        } else {
            //스크롤중..
        }
    });
</script>

</html>